{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.3", "generated_at": "2026-02-10T18:19:56.492883Z", "invocation_id": "0a2b84d6-f8b6-4c70-a95b-99eeb6fdfc42", "invocation_started_at": "2026-02-10T18:19:50.813810Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:52.552722Z", "completed_at": "2026-02-10T18:19:52.563119Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:52.564624Z", "completed_at": "2026-02-10T18:19:52.707619Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1578960418701172, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enpal_assessment_project.stg_activity", "compiled": true, "compiled_code": "-- Cleans raw activity data, standardizes column names and types\n\n\nwith activity_cte as (\n    select *,\n    row_number() \n    over(partition by activity_id order by due_to desc) rank_val\n    from \"postgres\".\"public\".\"activity\"\n)\n\nselect\n    activity_id,\n    lower(nullif(trim(type), '')) as activity_type,\n    assigned_to_user as user_id,\n    deal_id::int as deal_id,\n    case \n    when done = true then 1\n    when done = false then 0\n    END AS is_completed,\n    due_to::timestamp as due_date -- cast due_to to timestamp\nfrom activity_cte\nwhere rank_val=1", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_activity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:52.718680Z", "completed_at": "2026-02-10T18:19:52.723321Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:52.724277Z", "completed_at": "2026-02-10T18:19:52.812323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09719491004943848, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enpal_assessment_project.stg_activity_types", "compiled": true, "compiled_code": "\n\nwith activity_types_cte as (\n    select *\n    from \"postgres\".\"public\".\"activity_types\"\n)\n\nselect\n    id as activity_id,\n    name as activity_name,\n    -- convert 'Yes'/'No'  to 1 for true and 0 for false\n    case \n        when lower(trim(active)) = 'yes' then 1\n        else 0\n    end as is_active,\n    lower(nullif(trim(type), '')) as activity_type\nfrom activity_types_cte", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_activity_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:52.822056Z", "completed_at": "2026-02-10T18:19:52.826606Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:52.827568Z", "completed_at": "2026-02-10T18:19:52.911489Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09255242347717285, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_changes", "compiled": true, "compiled_code": "-- Staging model for the deal_changes table\n\n\n\nwith deal_changes_cte as (\n    select *\n    from \"postgres\".\"public\".\"deal_changes\"\n)\n\nselect\n    deal_id::int as deal_id,\n    change_time::timestamp as deal_updated_ts,\n    changed_field_key as deal_tracked_key,\n    new_value as deal_value_updated\nfrom deal_changes", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:52.920638Z", "completed_at": "2026-02-10T18:19:52.926642Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:52.927641Z", "completed_at": "2026-02-10T18:19:53.011581Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09359908103942871, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enpal_assessment_project.stg_fields", "compiled": true, "compiled_code": "-- Staging model for the fields table\n\n\nwith fields_cte as (\n    select *\n    from \"postgres\".\"public\".\"fields\"\n)\n\nselect\n    id as field_id,\n    field_key,\n    name as field_name,\n    field_value_options,\n    (json_pair->> 'id') :: int as field_stage_id,\n    (json_pair->> 'label') :: varchar as field_stage_description\nfrom fields_cte\nLEFT JOIN LATERAL \njsonb_array_elements(\n    CASE \n    WHEN \nfield_value_options is not null and field_value_options :: jsonb is not null\n THEN field_value_options :: jsonb\n    ELSE '[]' :: jsonb\n    END \n) as json_pair\nON TRUE", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_fields\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:53.020725Z", "completed_at": "2026-02-10T18:19:53.025233Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:53.026237Z", "completed_at": "2026-02-10T18:19:53.112393Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09501433372497559, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enpal_assessment_project.stg_stages", "compiled": true, "compiled_code": "-- Staging model for the stages table\n\n\n\nwith stages_cte as (\n    select *\n    from \"postgres\".\"public\".\"stages\"\n)\n\nselect\nstage_id,\nstage_name\nfrom stages_cte", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:53.122267Z", "completed_at": "2026-02-10T18:19:53.126904Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:53.128271Z", "completed_at": "2026-02-10T18:19:53.219906Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09963631629943848, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enpal_assessment_project.stg_users", "compiled": true, "compiled_code": "-- Staging model for the users table\n\n\n\nwith users_cte as (\n    select  *,\n    ROW_NUMBER() OVER (PARTITION by email,name order by modified desc) as rank_val\n\n    from \"postgres\".\"public\".\"users\"\n)\n\nselect\nid as user_id,\nname as user_name,\nemail as user_email,\nmodified::timestamp as modified_ts\nfrom users_cte where rank_val=1", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:53.229593Z", "completed_at": "2026-02-10T18:19:53.235590Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:53.235590Z", "completed_at": "2026-02-10T18:19:53.375293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1478586196899414, "adapter_response": {"_message": "SELECT 8891", "code": "SELECT", "rows_affected": 8891}, "message": "SELECT 8891", "failures": null, "unique_id": "model.enpal_assessment_project.int_deal_stages_enriched", "compiled": true, "compiled_code": "\n\nwith deals AS\n(\nselect \ndeal_id,\ndeal_updated_ts,\ndeal_tracked_key,\nNULLIF(deal_value_updated, '')::int as deal_value_updated\nfrom \n\"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\" where deal_tracked_key='stage_id'\n),\n\nstages AS\n(\nselect\nstage_id :: int as stage_id,\nstage_name\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_stages\"\n),\nde_duplicate_deals AS\n(\nselect \nd.deal_id,\ns.stage_id,\ns.stage_name,\nd.deal_updated_ts,\nROW_NUMBER() over(PARTITION by d.deal_id,s.stage_id order by d.deal_updated_ts desc) row_rank\n\nfrom \ndeals d\nLEFT JOIN stages s ON d.deal_value_updated=s.stage_id\n)\nselect \ndeal_id,\nstage_id,\nstage_name,\ndeal_updated_ts\nfrom \nde_duplicate_deals\nwhere row_rank=1", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"int_deal_stages_enriched\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:53.386249Z", "completed_at": "2026-02-10T18:19:53.391240Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:53.392746Z", "completed_at": "2026-02-10T18:19:55.230034Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8522663116455078, "adapter_response": {"_message": "SELECT 1718", "code": "SELECT", "rows_affected": 1718}, "message": "SELECT 1718", "failures": null, "unique_id": "model.enpal_assessment_project.int_activities_enriched", "compiled": true, "compiled_code": "\n\nwith activities as (\n\n    select\n        activity_id,\n        activity_type,\n        user_id,\n        deal_id,\n        due_date,\n        is_completed\n    from \"postgres\".\"public_pipedrive_analytics\".\"stg_activity\" where is_completed=1\n\n),\n\nactivity_types as (\n\n    select\n        activity_type,\n        activity_name\n    from \"postgres\".\"public_pipedrive_analytics\".\"stg_activity_types\" where is_active=1\n\n),\n\nusers as (\n\n    select\n        user_id,\n        user_name,\n        user_email,\n        modified_ts\n    from \"postgres\".\"public_pipedrive_analytics\".\"stg_users\"\n\n)\n\nselect \na.activity_id,\na.deal_id,\na.is_completed,\nu.user_id,\na.activity_type,\nt.activity_name,\nu.user_name,\nu.user_email,\nu.modified_ts,\na.due_date\nfrom \nactivities a\n\nINNER JOIN activity_types t \n    on lower(trim(a.activity_type)) = lower(trim(t.activity_type))\n\nINNER JOIN users u \n    on a.user_id = u.user_id", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"int_activities_enriched\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T18:19:55.270063Z", "completed_at": "2026-02-10T18:19:55.287722Z"}, {"name": "execute", "started_at": "2026-02-10T18:19:55.291961Z", "completed_at": "2026-02-10T18:19:56.426325Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1660287380218506, "adapter_response": {"_message": "SELECT 111", "code": "SELECT", "rows_affected": 111}, "message": "SELECT 111", "failures": null, "unique_id": "model.enpal_assessment_project.rep_sales_funnel_monthly", "compiled": true, "compiled_code": "with dim_user_activity as\n(\nSELECT\nactivity_type,\nactivity_name,\ndeal_id,\nuser_name\nfrom \"postgres\".\"public_pipedrive_analytics\".\"int_activities_enriched\"\n),\ndim_deal_progress as \n(\nselect\ndeal_id,\nstage_id,\nstage_name,\ndate_trunc('month', deal_updated_ts) as month_start\nfrom \"postgres\".\"public_pipedrive_analytics\".\"int_deal_stages_enriched\"\n),\nbase_stage AS\n(\n    SELECT\n    month_start,\n    stage_id:: text as funnel_step,\n    stage_name as kpi_name,\n    deal_id\n    FROM dim_deal_progress\n),\nsub_stages AS (\n    -- Step 2.1: Sales Call 1\n    SELECT\n        d.month_start,\n        '2.1' AS funnel_step,\n        'SALES CALL 1' AS kpi_name,\n        d.deal_id\n    FROM dim_deal_progress d\n    WHERE d.stage_id = 2\n      AND EXISTS (\n          SELECT 1\n          FROM dim_user_activity a\n          WHERE a.deal_id = d.deal_id\n            AND a.activity_type = 'meeting'\n      )\n    UNION ALL\n    -- Step 3.1: Sales Call 2\n    SELECT\n        d.month_start,\n        '3.1' AS funnel_step,\n        'SALES CALL 2' AS kpi_name,\n        d.deal_id\n    FROM dim_deal_progress d\n    WHERE d.stage_id = 3\n      AND EXISTS (\n          SELECT 1\n          FROM dim_user_activity a\n          WHERE a.deal_id = d.deal_id\n            AND a.activity_type = 'sc_2'\n      )\n),\nfinal_monthly_report as\n(\nSELECT * FROM base_stage\nUNION ALL\nSELECT * FROM sub_stages\n)\n\nSELECT \nTO_CHAR(DATE_TRUNC('month', month_start), 'MM-YYYY') as month,\nfunnel_step,\nkpi_name,\nCOUNT(DISTINCT deal_id) as deal_count\nfrom\nfinal_monthly_report\ngroup by MONTH,funnel_step,kpi_name\nORDER BY month,CAST(funnel_step AS DOUBLE PRECISION)", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"rep_sales_funnel_monthly\"", "batch_results": null}], "elapsed_time": 4.2955849170684814, "args": {"use_colors": true, "require_unique_project_resource_names": false, "defer": false, "partial_parse_file_diff": true, "favor_state": false, "source_freshness_run_project_hooks": true, "print": true, "macro_debugging": false, "log_level_file": "debug", "empty": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "show_all_deprecations": false, "strict_mode": false, "upload_to_artifacts_ingest_api": false, "introspect": true, "log_format": "default", "require_resource_names_without_spaces": true, "send_anonymous_usage_stats": true, "use_fast_test_edges": false, "require_nested_cumulative_type_params": false, "version_check": true, "write_json": true, "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "require_generic_test_arguments_property": true, "state_modified_compare_vars": false, "quiet": false, "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "log_level": "info", "partial_parse": true, "show_resource_report": false, "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "select": [], "populate_cache": true, "printer_width": 80, "state_modified_compare_more_unrendered_values": false, "static_parser": true, "log_file_max_bytes": 10485760, "log_path": "C:\\Users\\Public\\dbt_enpal_assessment\\logs", "require_all_warnings_handled_by_warn_error": false, "which": "run", "indirect_selection": "eager", "invocation_command": "dbt run", "project_dir": "C:\\Users\\Public\\dbt_enpal_assessment", "profiles_dir": "C:\\Users\\Public\\dbt_enpal_assessment", "validate_macro_args": false, "exclude": [], "require_ref_searches_node_package_before_root": false, "require_batched_execution_for_custom_microbatch_strategy": false}}